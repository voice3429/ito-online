<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>ito - 部屋に参加</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
  <h1>ito オンライン - 部屋に参加</h1>
  <label for="roomId">部屋コード:</label>
  <input type="text" id="roomId" />
  <button onclick="joinRoom()">部屋に参加</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBtoNLxqw_TnTSxdNG7gtb308S0jr5pzpE",
      authDomain: "ito-online-4348a.firebaseapp.com",
      databaseURL: "https://ito-online-4348a-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "ito-online-4348a",
      storageBucket: "ito-online-4348a.appspot.com",
      messagingSenderId: "840014772869",
      appId: "1:840014772869:web:8230edfc917d7a393a47ec"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function joinRoom() {
      const roomId = document.getElementById("roomId").value;
      const playerName = prompt("あなたの名前を入力してください");

      if (!playerName) return;

      // 部屋に参加
      db.ref("rooms/" + roomId + "/players/" + playerName).set({
        hint: "",
        number: null,
        ready: false
      }).then(() => {
        console.log(`${playerName} が部屋に参加しました！`);
        window.location.href = `room.html?room=${roomId}&name=${encodeURIComponent(playerName)}`;
      }).catch(error => {
        console.error("参加エラー:", error);
        alert("部屋への参加に失敗しました！コンソールを確認してください");
      });
    }
  </script>
</body>
</html>
